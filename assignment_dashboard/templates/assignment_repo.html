{% extends "layout.html" %}
{% block title %}{{ assignment_repo.owner.login }}/{{ assignment_repo.name }}{% endblock %}

{% block breadcrumbs %}
  <li>{{ classroom_owner.login }}</li>
  <li class="active">{{ assignment_repo.name }}</li>
{% endblock %}

{% block header %}
  <div class="jumbotron">
    <div class="container">
      <h3>
        {{ assignment_repo.name }}
        <small>({{ classroom_owner.fullname or classroom_owner.login | capitalize }})</small>
      </h3>
    </div>
  </div>

  <div class="container">
    <div class="alert alert-info alert-dismissible" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <p>{% if repo_update_time %}Updated {{ repo_update_time.strftime('%l:%M%P, %B %d') }}.{% else %}Never updated.{% endif %}</p>
      <p>Execute the <tt>flask updatedb</tt> command to update the database.</p>
    </div>
  </div>
{% endblock %}

{% block content %}
  <div>
    <a class="btn btn-default btn-sm" href="{{ url_for('assignment_repo_csv', repo_id=assignment_repo.id )}}">Download CSV <i class="fa fa-table" aria-hidden="true"></i></a>
  </div>

  <table class="table table-condensed table-striped">
    <tr>
      <th></th>
      {% for assignment in assignments %}
        <th><a href="{{ url_for('assignment', assignment_id=assignment.id) }}" title="View the combined notebook">{{ assignment.name or assignment.path }}</a></th>
      {% endfor %}
    </tr>

    {% for student in students %}
      <tr>
        <th><a href="{{ student.repo.html_url }}" title="View the student repo on GitHub">{{ student.display_name }}</a></th>
        {% for assignment in assignments %}
          {% set response = responses[assignment.id][student.user.id] %}
          <td class="{{ response.css_class }}">
            <a href="{{ student.repo.html_url }}/blob/master/{{ assignment.path }}" title="{{ response.hover }}">
              {{ response.text }}
            </a>
          </td>
        {% endfor %}
      </tr>
    {% endfor %}
  </table>
{% endblock %}
